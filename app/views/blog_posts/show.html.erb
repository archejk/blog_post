<article class="bg-white rounded-lg shadow-md p-8 mb-8" data-controller="blog-post">
  <header class="mb-6">
    <h1 class="text-3xl font-bold text-gray-900 mb-4"><%= @blog_post.title %></h1>
    <div class="flex justify-between items-center text-sm text-gray-600">
      <p>By <%= @blog_post.author_name %> • <%= @blog_post.created_at.strftime("%B %d, %Y at %I:%M %p") %></p>
      <div class="space-x-2">
        <%= link_to "Edit", edit_blog_post_path(@blog_post), class: "text-blue-600 hover:text-blue-800" %>
        <%= link_to "Delete", @blog_post, method: :delete, 
            confirm: "Are you sure?", 
            class: "text-red-600 hover:text-red-800" %>
      </div>
    </div>
  </header>

  <div class="prose max-w-none mb-8">
    <%= simple_format(@blog_post.content) %>
  </div>
</article>

<!-- Feedback Section -->
<section class="bg-white rounded-lg shadow-md p-8" data-controller="feedback-form">
  <h2 class="text-2xl font-semibold text-gray-900 mb-6">Leave Feedback</h2>

  <%= form_with model: [@blog_post, Feedback.new], data: { controller: "feedback-form", action: "submit->feedback-form#submit" } do |form| %>
    <%= hidden_field_tag :debug_mode, "true" %>
    <% if @feedback.errors.any? %>
      <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
        <ul class="list-disc list-inside">
          <% @feedback.errors.full_messages.each do |message| %>
            <li><%= message %></li>
          <% end %>
        </ul>
      </div>
    <% end %>

    <div class="grid md:grid-cols-2 gap-4">
      <div>
        <%= form.label :name, class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= form.text_field :name, 
            required: true,
            class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" %>
      </div>
      
      <div>
        <%= form.label :email, class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= form.email_field :email, 
            required: true,
            class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" %>
      </div>
    </div>
    
    <div>
      <%= form.label :message, class: "block text-sm font-medium text-gray-700 mb-1" %>
      <%= form.text_area :message, rows: 4,
          required: true,
          class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" %>
    </div>
    
    <div>
      <%= form.submit "Send Feedback", class: "bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors cursor-pointer" %>
    </div>
  <% end %>
</section>

<div class="mt-6">
  <%= link_to "← Back to All Posts", root_path, class: "text-blue-600 hover:text-blue-800" %>
</div>